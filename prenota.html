<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Prenotazioni â€“ Altrove Leukerbad</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    body {
      font-family: sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 2rem;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: white;
      padding: 2rem;
      border-radius: 16px;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
    }
    iframe {
      width: 100%;
      height: 500px;
      border: none;
      margin-bottom: 2rem;
    }
    form label {
      display: block;
      margin-top: 1rem;
    }
    form input, form select {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.3rem;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    .total-summary {
      margin-top: 2rem;
      padding: 1rem;
      background: #f9f9f9;
      border-radius: 8px;
    }
    .submit-button {
      margin-top: 2rem;
      background: #444;
      color: white;
      padding: 1rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      width: 100%;
      font-size: 1rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Prenota il tuo soggiorno</h2>

    <!-- Calendario pubblico Google Calendar -->
    <iframe src="https://calendar.google.com/calendar/embed?src=altrove.leukerbad%40gmail.com&ctz=Europe%2FZurich"></iframe>

    <!-- Modulo di prenotazione -->
    <form action="https://formspree.io/f/xpwrprzr" method="POST" oninput="updatePrices()">
      <label for="nome">Nome:</label>
      <input type="text" id="nome" name="nome" required>

      <label for="cognome">Cognome:</label>
      <input type="text" id="cognome" name="cognome" required>

      <label for="email">Email:</label>
      <input type="email" id="email" name="email" required>

      <label for="checkin">Data check-in:</label>
      <input type="date" id="checkin" name="checkin" required>

      <label for="checkout">Data check-out:</label>
      <input type="date" id="checkout" name="checkout" required>

      <label for="adulti">Adulti (16+):</label>
      <input type="number" id="adulti" name="adulti" min="0" value="2">

      <label for="ragazzi">Ragazzi (6-16):</label>
      <input type="number" id="ragazzi" name="ragazzi" min="0" value="0">

      <label for="bambini">Bambini (0-6):</label>
      <input type="number" id="bambini" name="bambini" min="0" value="0">

      <div class="total-summary">
        <p><strong>Prezzo per notte:</strong> <span id="prezzoNotte">CHF 0</span></p>
        <p><strong>Costo appartamento:</strong> <span id="costoAppartamento">CHF 0</span></p>
        <p><strong>Tassa soggiorno:</strong> <span id="tassaSoggiorno">CHF 0</span></p>
        <p><strong>Pulizia:</strong> CHF 120</p>
        <hr>
        <p><strong>Totale soggiorno:</strong> <span id="totale">CHF 0</span></p>
      </div>

      <button type="submit" class="submit-button">Prenota ora</button>
    </form>
  </div>

  <script>
    const stagioni = [
      { da: '04-07', a: '05-31', prezzo: 110 },
      { da: '06-01', a: '06-30', prezzo: 130 },
      { da: '07-01', a: '08-31', prezzo: 160 },
      { da: '09-01', a: '09-30', prezzo: 130 },
      { da: '10-01', a: '12-15', prezzo: 110 },
      { da: '12-16', a: '12-20', prezzo: 220 },
      { da: '12-21', a: '01-08', prezzo: 350 },
      { da: '01-09', a: '04-06', prezzo: 220 },
    ];

    function updatePrices() {
      const checkin = document.getElementById('checkin').value;
      const checkout = document.getElementById('checkout').value;
      const adulti = parseInt(document.getElementById('adulti').value || 0);
      const ragazzi = parseInt(document.getElementById('ragazzi').value || 0);
      const bambini = parseInt(document.getElementById('bambini').value || 0);

      if (!checkin || !checkout) return;

      const d1 = new Date(checkin);
      const d2 = new Date(checkout);
      const diffTime = d2 - d1;
      const notti = diffTime / (1000 * 60 * 60 * 24);
      if (notti < 2) {
        document.getElementById('totale').innerText = 'Soggiorno minimo 2 notti';
        return;
      }

      let prezzoTotale = 0;
      for (let i = 0; i < notti; i++) {
        const giorno = new Date(d1);
        giorno.setDate(giorno.getDate() + i);
        const mmdd = (giorno.getMonth()+1).toString().padStart(2,'0') + '-' + giorno.getDate().toString().padStart(2,'0');
        const stagione = stagioni.find(s => mmdd >= s.da && mmdd <= s.a);
        prezzoTotale += stagione ? stagione.prezzo : 0;
      }
      const mediaNotte = Math.round(prezzoTotale / notti);
      const tassa = notti * (adulti * 6 + ragazzi * 3);
      const totale = prezzoTotale + tassa + 120;

      document.getElementById('prezzoNotte').innerText = `CHF ${mediaNotte}`;
      document.getElementById('costoAppartamento').innerText = `CHF ${prezzoTotale}`;
      document.getElementById('tassaSoggiorno').innerText = `CHF ${tassa}`;
      document.getElementById('totale').innerText = `CHF ${totale}`;
    }
  </script>
</body>
</html>
